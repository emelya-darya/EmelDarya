"use strict";
//!------------------------------------Появление заголовка-------------------------------------------------------------
document.addEventListener("DOMContentLoaded",(function(e){document.querySelector(".presentation__title").classList.add("_visible")}));const arrayBulletsClass=["icon-home","icon-astronaut","icon-folder","icon-whatsapp","icon-envelope","icon-arrow-up"],pagesSwiper=new Swiper(".main-swiper",{direction:"vertical",wrapperClass:"main-swiper__pages",slideClass:"main-swiper__page",slidesPerView:"auto",keyboard:{enabled:!0,onlyInViewport:!0,pageUpDown:!0},mousewheel:{sensitivity:1},watchOverflow:!0,speed:800,observer:!0,observeParents:!0,observeSlideChildren:!0,pagination:{el:".main-swiper__pagination",type:"bullets",clickable:!0,bulletClass:"main-swiper__bullet",bulletActiveClass:"main-swiper__bullet_active",renderBullet:function(e,t){return`<div class="${t}"> <span class="${arrayBulletsClass[e]}"></span> </div>`}},scrollbar:{el:".main-swiper__scrollbar",dragClass:"main-swiper__scrollbar-toddler",draggable:!0},ally:{enabled:!0}});
//!--------------------------------------Главный свайпер------------------------------------------------
pagesSwiper.on("slideChange",(function(){const e=document.querySelector(".skills");document.querySelector(".swiper-slide-next")!=e||document.querySelector(".skills.already-anim")||(e.classList.add("already-anim"),gsap.fromTo(".greeting__letter",{y:-30,opacity:0},{y:0,opacity:1,duration:1,delay:.3,stagger:.1,repeat:0}),setTimeout((()=>{document.querySelector(".greeting__paragraph").classList.add("_visible")}),1e3));const t=document.querySelector(".works");document.querySelector(".swiper-slide-next")!=t||document.querySelector(".works.already-anim")||(t.classList.add("already-anim"),gsap.timeline({repeat:0}).fromTo(".works__letter",{y:-30,opacity:0},{y:0,opacity:1,duration:1,delay:.3,stagger:.05,repeat:0}).fromTo(".works__link",{opacity:0},{opacity:1,duration:2,delay:.1,stagger:.05,repeat:0},"-=1"));const a=document.querySelector(".contacts");document.querySelector(".swiper-slide-next")!=a||document.querySelector(".contacts.already-anim")||(a.classList.add("already-anim"),gsap.timeline({repeat:0}).fromTo(".contacts__letter",{y:-30,opacity:0},{y:0,opacity:1,duration:1,delay:.3,stagger:.05,repeat:0}));const r=document.querySelector(".form-email");document.querySelector(".swiper-slide-next")!=r||document.querySelector(".form-email.already-anim")||(r.classList.add("already-anim"),gsap.timeline({repeat:0}).fromTo(".form-email__letter",{y:-30,opacity:0},{y:0,opacity:1,duration:1,delay:.3,stagger:.05,repeat:0}))}));const scrollUp=document.querySelector(".scroll-up__arrow");scrollUp.addEventListener("click",(e=>{pagesSwiper.slideTo(0,1e3,!0)}));
//!-----------------------------------------------------------------Анимация космос на главной-----------------------------------------------
const canvasContainer=document.querySelector(".presentation"),canvas=document.querySelector(".presentation__canvas"),contextC=canvas.getContext("2d");let wCan=canvas.width=canvasContainer.offsetWidth-40,hCan=canvas.height=canvasContainer.offsetHeight-30;window.addEventListener("resize",(()=>{wCan=canvas.width=canvasContainer.offsetWidth-40,hCan=canvas.height=canvasContainer.offsetHeight-30}));const particlesC=[],propertiesC={bgColor:"rgba(0, 0, 0, 0)",particleColor:"rgba(255, 40, 40, 1)",particleRadius:3,particleCount:70,particleMaxSpeed:.5,lineLength:150,particleLive:25};class ParticleC{constructor(){this.x=Math.random()*wCan,this.y=Math.random()*hCan,this.speedX=Math.random()*(2*propertiesC.particleMaxSpeed)-propertiesC.particleMaxSpeed,this.speedY=Math.random()*(2*propertiesC.particleMaxSpeed)-propertiesC.particleMaxSpeed,this.live=Math.random()*propertiesC.particleLive*60}reDraw(){contextC.beginPath(),contextC.arc(this.x,this.y,propertiesC.particleRadius,0,2*Math.PI),contextC.closePath(),contextC.fillStyle=propertiesC.particleColor,contextC.fill()}position(){this.x+this.speedX>wCan&&this.speedX>0||this.x+this.speedX<0&&this.speedX<0?this.speedX*=-1:this.speedX,this.y+this.speedY>hCan&&this.speedY>0||this.y+this.speedY<0&&this.speedY<0?this.speedY*=-1:this.speedY,this.x+=this.speedX,this.y+=this.speedY}recalculateLive(){this.live<1&&(this.x=Math.random()*wCan,this.y=Math.random()*hCan,this.speedX=Math.random()*(2*propertiesC.particleMaxSpeed)-propertiesC.particleMaxSpeed,this.speedY=Math.random()*(2*propertiesC.particleMaxSpeed)-propertiesC.particleMaxSpeed,this.live=Math.random()*propertiesC.particleLive*60),this.live--}}function redrawBgC(){contextC.fillStyle=propertiesC.bgColor,contextC.fillRect(0,0,wCan,hCan)}function drawLines(){let e,t,a,r,i,s;for(let o in particlesC)for(let n in particlesC)e=particlesC[o].x,t=particlesC[o].y,a=particlesC[n].x,r=particlesC[n].y,i=Math.sqrt((e-a)**2+(t-r)**2),i<propertiesC.lineLength&&(s=1-i/propertiesC.lineLength,contextC.lineWidth="0,5",contextC.strokeStyle="rgba(255,40,40,"+s+")",contextC.beginPath(),contextC.moveTo(e,t),contextC.lineTo(a,r),contextC.closePath(),contextC.stroke())}function redrawParticles(){particlesC.forEach((e=>{e.recalculateLive(),e.position(),e.reDraw()}))}function loopC(){contextC.clearRect(0,0,wCan,hCan),redrawBgC(),redrawParticles(),drawLines(),requestAnimationFrame(loopC)}function initC(){for(let e=0;e<propertiesC.particleCount;e++)particlesC.push(new ParticleC);loopC()}initC();
//!---------------------------------------------Облако тегов-----------------------------------------------------------
let cloudTag=document.querySelector("#SkillsCanvas");innerWidth>992&&(cloudTag.width=cloudTag.height=600),innerWidth<=992&&(cloudTag.width=cloudTag.height=300),TagCanvas.Start("SkillsCanvas","tags",{textColour:"#FF2828",textHeight:19,textFont:"Comic Sans MS, Arial, sans-serif",shadow:"#FF2828",outlineMethod:"none",wheelZoom:!1});
//! ----------------------------------------------------------------Валидация и отправка формы----------------------------------------------------------
const thanksWindow=document.querySelector(".thanks-window"),formMail=new JustValidate(".form-email__form",{errorFieldCssClass:"is-invalid"});formMail.addField(".form-email__name",[{rule:"required",value:!0,errorMessage:"Insert your name"}]).addField(".form-email__email",[{rule:"required",value:!0,errorMessage:"Insert email address"},{rule:"email",value:!0,errorMessage:"Еnter a valid address"}]).addField(".form-email__message",[{rule:"required",value:!0,errorMessage:"Empty field"},{rule:"minLength",value:5,errorMessage:"Too short message("}]).onSuccess((e=>{console.log("Validation passes and form submitted",e);let t=new FormData(e.target);console.log(...t);let a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&200===a.status&&(thanksWindow.classList.add("_visible"),setTimeout((()=>{thanksWindow.classList.remove("_visible")}),15e3))},a.open("POST","php/sendmail.php",!0),a.send(t),e.target.reset()}));const closeThanksWindow=document.querySelector(".thanks-window-close");closeThanksWindow.addEventListener("click",(()=>{thanksWindow.classList.remove("_visible")}));